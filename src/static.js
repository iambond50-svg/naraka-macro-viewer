// è‡ªåŠ¨ç”Ÿæˆçš„é™æ€æ–‡ä»¶å†…å®¹ - è¯·å‹¿æ‰‹åŠ¨ç¼–è¾‘
export const INDEX_HTML = "<!DOCTYPE html>\r\n<html lang=\"zh-CN\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>æ°¸åŠ«æ— é—´å®é”®ä½æŸ¥çœ‹å™¨</title>\r\n    <link rel=\"stylesheet\" href=\"style.css\">\r\n</head>\r\n<body>\r\n    <div class=\"container\">\r\n        <header>\r\n            <h1>ğŸ® æ°¸åŠ«æ— é—´å®é”®ä½æŸ¥çœ‹å™¨</h1>\r\n            <p class=\"subtitle\">æŸ¥çœ‹å’Œæœç´¢å®é”®ä½é…ç½® | ä¸€é”®åŒæ­¥åˆ°ATK Hub</p>\r\n        </header>\r\n\r\n        <div class=\"controls\">\r\n            <div class=\"search-box\">\r\n                <input type=\"text\" id=\"searchInput\" placeholder=\"æœç´¢å®åç§°æˆ–æŒ‰é”®...\">\r\n                <button id=\"searchBtn\">ğŸ” æœç´¢</button>\r\n            </div>\r\n            <div class=\"filter-box\">\r\n                <label for=\"categoryFilter\">åˆ†ç±»ç­›é€‰ï¼š</label>\r\n                <select id=\"categoryFilter\">\r\n                    <option value=\"\">å…¨éƒ¨</option>\r\n                </select>\r\n            </div>\r\n            <div class=\"export-box\">\r\n                <button id=\"syncATKBtn\" class=\"export-btn sync-btn\">ğŸ”„ åŒæ­¥åˆ°ATK Hub</button>\r\n            </div>\r\n            <div class=\"stats\">\r\n                <span id=\"totalCount\">æ€»è®¡: 0 ä¸ªå®</span>\r\n                <span id=\"filteredCount\"></span>\r\n            </div>\r\n        </div>\r\n\r\n        <div id=\"macroList\" class=\"macro-list\">\r\n            <div class=\"loading\">æ­£åœ¨åŠ è½½å®æ•°æ®...</div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- è¯¦ç»†ä¿¡æ¯æ¨¡æ€çª—å£ -->\r\n    <div id=\"macroModal\" class=\"modal\">\r\n        <div class=\"modal-content\">\r\n            <div class=\"modal-header\">\r\n                <h2 id=\"modalTitle\">å®è¯¦ç»†ä¿¡æ¯</h2>\r\n                <span class=\"modal-close\">&times;</span>\r\n            </div>\r\n            <div class=\"modal-body\" id=\"modalBody\">\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <!-- ATK HubåŒæ­¥æ¨¡æ€çª—å£ -->\r\n    <div id=\"atkSyncModal\" class=\"modal\">\r\n        <div class=\"modal-content modal-lg\">\r\n            <div class=\"modal-header\">\r\n                <h2>ğŸ”„ åŒæ­¥åˆ° ATK Hub</h2>\r\n                <span class=\"modal-close\" onclick=\"closeATKSyncModal()\">&times;</span>\r\n            </div>\r\n            <div class=\"modal-body\">\r\n                <div class=\"sync-instructions\">\r\n                    <h3>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h3>\r\n                    <ol>\r\n                        <li>å…ˆæ‰“å¼€ <a href=\"https://hub.atk.pro/\" target=\"_blank\" class=\"link-atk\">ATK Hub</a> å¹¶è¿›å…¥æ¼”ç¤ºæ¨¡å¼</li>\r\n                        <li>åœ¨ä¸‹æ–¹å‹¾é€‰è¦åŒæ­¥çš„å®</li>\r\n                        <li>ç‚¹å‡»\"å¤åˆ¶åŒæ­¥ä»£ç \"ï¼Œç„¶ååœ¨ATK Hubæ§åˆ¶å°(F12)ç²˜è´´æ‰§è¡Œ</li>\r\n                    </ol>\r\n                </div>\r\n                \r\n                <div class=\"sync-options\">\r\n                    <div class=\"sync-option-row\">\r\n                        <div class=\"sync-option\">\r\n                            <label for=\"syncDevice\">ç›®æ ‡è®¾å¤‡:</label>\r\n                            <select id=\"syncDevice\">\r\n                                <option value=\"ATK x QK Hex80\">ATK x QK Hex80 (é”®ç›˜)</option>\r\n                                <option value=\"ATK F1 Ultimate 2.0\">ATK F1 Ultimate 2.0 (é¼ æ ‡)</option>\r\n                                <option value=\"ATK RS6\">ATK RS6 (é¼ æ ‡)</option>\r\n                            </select>\r\n                        </div>\r\n                        <div class=\"sync-option\">\r\n                            <label for=\"syncMode\">åŒæ­¥æ¨¡å¼:</label>\r\n                            <select id=\"syncMode\">\r\n                                <option value=\"replace\">æ›¿æ¢æ¨¡å¼</option>\r\n                                <option value=\"append\">è¿½åŠ æ¨¡å¼</option>\r\n                                <option value=\"merge\">åˆå¹¶æ¨¡å¼</option>\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                \r\n                <!-- å®é€‰æ‹©åŒºåŸŸ -->\r\n                <div class=\"macro-selection\">\r\n                    <div class=\"selection-header\">\r\n                        <h4>ğŸ® é€‰æ‹©è¦åŒæ­¥çš„å®</h4>\r\n                        <div class=\"selection-actions\">\r\n                            <button class=\"btn-sm\" onclick=\"selectAllMacros()\">å…¨é€‰</button>\r\n                            <button class=\"btn-sm\" onclick=\"deselectAllMacros()\">å–æ¶ˆå…¨é€‰</button>\r\n                            <span class=\"selected-count\">å·²é€‰: <strong id=\"selectedMacroCount\">0</strong> ä¸ª</span>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"macro-filter\">\r\n                        <input type=\"text\" id=\"syncSearchInput\" placeholder=\"æœç´¢å®åç§°...\" oninput=\"filterSyncMacros()\">\r\n                        <select id=\"syncCategoryFilter\" onchange=\"filterSyncMacros()\">\r\n                            <option value=\"\">å…¨éƒ¨åˆ†ç±»</option>\r\n                        </select>\r\n                    </div>\r\n                    <div class=\"macro-checkbox-list\" id=\"macroCheckboxList\">\r\n                        <div class=\"loading\">æ­£åœ¨åŠ è½½å®åˆ—è¡¨...</div>\r\n                    </div>\r\n                </div>\r\n                \r\n                <div class=\"sync-actions\">\r\n                    <button id=\"generateSyncBtn\" class=\"btn btn-primary\">ğŸ“‹ å¤åˆ¶åŒæ­¥ä»£ç </button>\r\n                    <button id=\"openATKHubBtn\" class=\"btn btn-secondary\" onclick=\"window.open('https://hub.atk.pro/', '_blank')\">ğŸŒ æ‰“å¼€ATK Hub</button>\r\n                </div>\r\n                \r\n                <div id=\"syncScriptPreview\" class=\"sync-preview\" style=\"display: none;\">\r\n                    <h4>åŒæ­¥ä»£ç  (å·²å¤åˆ¶åˆ°å‰ªè´´æ¿):</h4>\r\n                    <pre id=\"syncScriptContent\"></pre>\r\n                </div>\r\n                \r\n                <div class=\"sync-status\" id=\"syncStatus\"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <script src=\"app.js\"></script>\r\n</body>\r\n</html>\r\n";
export const APP_JS = "/**\r\n * æ°¸åŠ«æ— é—´å®æŸ¥çœ‹å™¨ - Cloudflare Workers + D1 ç‰ˆæœ¬\r\n * ä»APIåŠ è½½æ•°æ®ï¼ŒATKåŒæ­¥åœ¨å‰ç«¯å®ç°\r\n */\r\n\r\n// APIåŸºç¡€è·¯å¾„\r\nconst API_BASE = '/api';\r\n\r\n// å…¨å±€æ•°æ®\r\nlet allMacros = [];\r\nlet currentPage = 1;\r\nlet totalPages = 1;\r\nlet totalCount = 0;\r\nconst perPage = 50;\r\n\r\n// ===== æ•°æ®åŠ è½½ =====\r\n\r\nasync function loadMacroData() {\r\n    try {\r\n        // åŠ è½½åˆ†ç±»åˆ—è¡¨\r\n        await loadCategories();\r\n        // åŠ è½½å®åˆ—è¡¨\r\n        await loadMacros();\r\n    } catch (error) {\r\n        console.error('åŠ è½½å®æ•°æ®å¤±è´¥:', error);\r\n        document.getElementById('macroList').innerHTML = `\r\n            <div class=\"no-results\">âŒ åŠ è½½å¤±è´¥: ${error.message}</div>\r\n        `;\r\n    }\r\n}\r\n\r\n// åŠ è½½åˆ†ç±»åˆ—è¡¨\r\nasync function loadCategories() {\r\n    const response = await fetch(`${API_BASE}/categories`);\r\n    const result = await response.json();\r\n    if (result.success) {\r\n        const categoryFilter = document.getElementById('categoryFilter');\r\n        result.data.forEach(cat => {\r\n            const option = document.createElement('option');\r\n            option.value = cat.name;\r\n            option.textContent = `${cat.name} (${cat.count})`;\r\n            categoryFilter.appendChild(option);\r\n        });\r\n    }\r\n}\r\n\r\n// åŠ è½½å®åˆ—è¡¨\r\nasync function loadMacros(page = 1) {\r\n    const searchTerm = document.getElementById('searchInput').value;\r\n    const category = document.getElementById('categoryFilter').value;\r\n    \r\n    const params = new URLSearchParams({ page, per_page: perPage });\r\n    if (searchTerm) params.append('search', searchTerm);\r\n    if (category) params.append('category', category);\r\n    \r\n    const response = await fetch(`${API_BASE}/macros?${params}`);\r\n    const result = await response.json();\r\n    \r\n    if (result.success) {\r\n        allMacros = result.data;\r\n        currentPage = result.pagination.page;\r\n        totalPages = result.pagination.total_pages;\r\n        totalCount = result.pagination.total;\r\n        \r\n        displayMacros(allMacros);\r\n        updateStats();\r\n        updatePagination();\r\n    }\r\n}\r\n\r\n// æ˜¾ç¤ºå®åˆ—è¡¨\r\nfunction displayMacros(macros) {\r\n    const macroList = document.getElementById('macroList');\r\n    \r\n    if (!macros || macros.length === 0) {\r\n        macroList.innerHTML = '<div class=\"no-results\">ğŸ˜• æ²¡æœ‰æ‰¾åˆ°åŒ¹é…çš„å®</div>';\r\n        return;\r\n    }\r\n    \r\n    macroList.innerHTML = macros.map(macro => createMacroCard(macro)).join('');\r\n}\r\n\r\n// åˆ›å»ºå®å¡ç‰‡HTML\r\nfunction createMacroCard(macro) {\r\n    const name = macro.name || 'æœªå‘½åå®';\r\n    const category = macro.category || 'æœªåˆ†ç±»';\r\n    const macroType = macro.macroType || macro.macro?.type || 'UNKNOWN';\r\n    \r\n    let keysHTML = '';\r\n    if (macroType === 'KEYSTROKE') {\r\n        keysHTML = renderKeystroke(macro.macro);\r\n    } else if (macroType === 'SEQUENCE') {\r\n        keysHTML = renderSequence(macro.macro);\r\n    }\r\n    \r\n    return `\r\n        <div class=\"macro-card\" data-macro-id=\"${macro.id}\" onclick=\"showMacroDetail('${macro.id}')\">\r\n            <div class=\"macro-header\">\r\n                <div class=\"macro-name\">${escapeHtml(name)}</div>\r\n                ${category !== 'æœªåˆ†ç±»' ? `<div class=\"macro-category\">${escapeHtml(category)}</div>` : ''}\r\n            </div>\r\n            <div class=\"macro-type\">ç±»å‹: ${macroType}</div>\r\n            <div class=\"macro-keys\">${keysHTML}</div>\r\n        </div>\r\n    `;\r\n}\r\n\r\n// ===== æ¸²æŸ“å‡½æ•° =====\r\n\r\nfunction renderKeystroke(macro) {\r\n    const actionName = macro.actionName || '';\r\n    if (actionName) {\r\n        return `<div class=\"key-display\">${escapeHtml(actionName)}</div>`;\r\n    }\r\n    \r\n    const code = macro.keystroke?.code;\r\n    const modifiers = macro.keystroke?.modifiers || [];\r\n    \r\n    let keys = [];\r\n    modifiers.forEach(mod => keys.push(getModifierName(mod)));\r\n    if (code) keys.push(getKeyName(code));\r\n    \r\n    return keys.map(key => `<div class=\"key-display\">${escapeHtml(key)}</div>`).join('');\r\n}\r\n\r\nfunction renderSequence(macro) {\r\n    const sequence = macro.sequence;\r\n    if (!sequence) return '<div class=\"sequence-info\">æ— åºåˆ—ä¿¡æ¯</div>';\r\n    \r\n    const defaultDelay = sequence.defaultDelay || 0;\r\n    let html = `<div class=\"sequence-info\">é»˜è®¤å»¶è¿Ÿ: ${defaultDelay}ms</div>`;\r\n    \r\n    const sequenceTypes = [\r\n        { key: 'simpleSequence', label: '' },\r\n        { key: 'heldSequence', label: '(æŒ‰ä½)' },\r\n        { key: 'toggleSequence', label: '(åˆ‡æ¢)' },\r\n        { key: 'pressSequence', label: '(æŒ‰ä¸‹)' },\r\n        { key: 'releaseSequence', label: '(é‡Šæ”¾)' }\r\n    ];\r\n    \r\n    for (const seqType of sequenceTypes) {\r\n        if (sequence[seqType.key]?.components?.length > 0) {\r\n            const components = sequence[seqType.key].components;\r\n            if (seqType.label) {\r\n                html += `<div class=\"sequence-info\">${seqType.label}</div>`;\r\n            }\r\n            html += '<div class=\"sequence-steps\">' + renderComponents(components) + '</div>';\r\n            break;\r\n        }\r\n    }\r\n    \r\n    return html;\r\n}\r\n\r\nfunction renderComponents(components) {\r\n    let html = '';\r\n    components.forEach(component => {\r\n        if (component.keyboard) {\r\n            const displayName = component.keyboard.displayName;\r\n            const isDown = component.keyboard.isDown;\r\n            const className = isDown ? 'key-down' : 'key-up';\r\n            const symbol = isDown ? 'â†“' : 'â†‘';\r\n            html += `<div class=\"sequence-step ${className}\">${symbol} ${escapeHtml(displayName)}</div>`;\r\n        } else if (component.delay) {\r\n            html += `<div class=\"sequence-step delay\">â± ${component.delay.durationMs}ms</div>`;\r\n        } else if (component.mouse) {\r\n            html += renderMouseAction(component.mouse);\r\n        } else if (component.mouseMacro) {\r\n            html += `<div class=\"sequence-step mouse-action\">ğŸ–± ${component.mouseMacro.action}</div>`;\r\n        }\r\n    });\r\n    return html;\r\n}\r\n\r\nfunction renderMouseAction(mouse) {\r\n    if (mouse.button) {\r\n        const buttonName = getMouseButtonName(mouse.button.hidUsage);\r\n        const isDown = mouse.button.isDown;\r\n        const symbol = isDown ? 'â†“' : 'â†‘';\r\n        const className = isDown ? 'mouse-down' : 'mouse-up';\r\n        return `<div class=\"sequence-step ${className}\">ğŸ–± ${symbol} ${buttonName}</div>`;\r\n    } else if (mouse.wheel) {\r\n        return `<div class=\"sequence-step mouse-wheel\">ğŸ–± ${getMouseWheelAction(mouse.wheel.hidUsage)}</div>`;\r\n    } else if (mouse.move) {\r\n        return `<div class=\"sequence-step mouse-move\">ğŸ–± ç§»åŠ¨ (${mouse.move.x || 0}, ${mouse.move.y || 0})</div>`;\r\n    }\r\n    return '';\r\n}\r\n\r\n// ===== é”®ç æ˜ å°„ =====\r\n\r\nfunction getModifierName(code) {\r\n    const modifiers = {\r\n        224: 'Ctrl', 225: 'Shift', 226: 'Alt', 227: 'Win',\r\n        228: 'Right Ctrl', 229: 'Right Shift', 230: 'Right Alt', 231: 'Right Win'\r\n    };\r\n    return modifiers[code] || `Mod${code}`;\r\n}\r\n\r\nfunction getKeyName(code) {\r\n    const keys = {\r\n        4: 'A', 5: 'B', 6: 'C', 7: 'D', 8: 'E', 9: 'F', 10: 'G', 11: 'H',\r\n        12: 'I', 13: 'J', 14: 'K', 15: 'L', 16: 'M', 17: 'N', 18: 'O', 19: 'P',\r\n        20: 'Q', 21: 'R', 22: 'S', 23: 'T', 24: 'U', 25: 'V', 26: 'W', 27: 'X',\r\n        28: 'Y', 29: 'Z',\r\n        30: '1', 31: '2', 32: '3', 33: '4', 34: '5', 35: '6', 36: '7', 37: '8',\r\n        38: '9', 39: '0',\r\n        40: 'Enter', 41: 'Esc', 42: 'Backspace', 43: 'Tab', 44: 'Space',\r\n        45: '-', 46: '=', 47: '[', 48: ']', 49: '\\\\', 51: ';', 52: '\\'',\r\n        53: '`', 54: ',', 55: '.', 56: '/',\r\n        58: 'F1', 59: 'F2', 60: 'F3', 61: 'F4', 62: 'F5', 63: 'F6',\r\n        64: 'F7', 65: 'F8', 66: 'F9', 67: 'F10', 68: 'F11', 69: 'F12'\r\n    };\r\n    return keys[code] || `Key${code}`;\r\n}\r\n\r\nfunction getMouseButtonName(hidUsage) {\r\n    const buttons = { '1': 'å·¦é”®', '2': 'å³é”®', '3': 'ä¸­é”®', '4': 'ä¾§é”®1', '5': 'ä¾§é”®2' };\r\n    return buttons[hidUsage] || `æŒ‰é”®${hidUsage}`;\r\n}\r\n\r\nfunction getMouseWheelAction(hidUsage) {\r\n    const wheels = { '1': 'æ»šè½®å‘ä¸Š', '2': 'æ»šè½®å‘ä¸‹', '6': 'æ»šè½®å‘ä¸Š', '7': 'æ»šè½®å‘ä¸‹' };\r\n    return wheels[hidUsage] || `æ»šè½®${hidUsage}`;\r\n}\r\n\r\n// ===== å·¥å…·å‡½æ•° =====\r\n\r\nfunction escapeHtml(text) {\r\n    const div = document.createElement('div');\r\n    div.textContent = text;\r\n    return div.innerHTML;\r\n}\r\n\r\nfunction searchMacros() {\r\n    currentPage = 1;\r\n    loadMacros(1);\r\n}\r\n\r\nfunction updateStats() {\r\n    document.getElementById('totalCount').textContent = `æ€»è®¡: ${totalCount} ä¸ªå®`;\r\n    document.getElementById('filteredCount').textContent = `æ˜¾ç¤º: ${allMacros.length} | ç¬¬ ${currentPage}/${totalPages} é¡µ`;\r\n    document.getElementById('filteredCount').style.display = 'inline-block';\r\n}\r\n\r\nfunction updatePagination() {\r\n    const existingPagination = document.querySelector('.pagination');\r\n    if (existingPagination) existingPagination.remove();\r\n    \r\n    if (totalPages <= 1) return;\r\n    \r\n    let html = '<div class=\"pagination\">';\r\n    \r\n    if (currentPage > 1) {\r\n        html += `<button class=\"page-btn\" onclick=\"goToPage(${currentPage - 1})\">Â« ä¸Šä¸€é¡µ</button>`;\r\n    }\r\n    \r\n    const startPage = Math.max(1, currentPage - 2);\r\n    const endPage = Math.min(totalPages, currentPage + 2);\r\n    \r\n    if (startPage > 1) {\r\n        html += `<button class=\"page-btn\" onclick=\"goToPage(1)\">1</button>`;\r\n        if (startPage > 2) html += '<span class=\"page-dots\">...</span>';\r\n    }\r\n    \r\n    for (let i = startPage; i <= endPage; i++) {\r\n        const activeClass = i === currentPage ? 'active' : '';\r\n        html += `<button class=\"page-btn ${activeClass}\" onclick=\"goToPage(${i})\">${i}</button>`;\r\n    }\r\n    \r\n    if (endPage < totalPages) {\r\n        if (endPage < totalPages - 1) html += '<span class=\"page-dots\">...</span>';\r\n        html += `<button class=\"page-btn\" onclick=\"goToPage(${totalPages})\">${totalPages}</button>`;\r\n    }\r\n    \r\n    if (currentPage < totalPages) {\r\n        html += `<button class=\"page-btn\" onclick=\"goToPage(${currentPage + 1})\">ä¸‹ä¸€é¡µ Â»</button>`;\r\n    }\r\n    \r\n    html += '</div>';\r\n    document.querySelector('.container').insertAdjacentHTML('beforeend', html);\r\n}\r\n\r\nfunction goToPage(page) {\r\n    if (page >= 1 && page <= totalPages) {\r\n        loadMacros(page);\r\n        window.scrollTo({ top: 0, behavior: 'smooth' });\r\n    }\r\n}\r\n\r\n// ===== å®è¯¦æƒ…æ¨¡æ€çª—å£ =====\r\n\r\nfunction showMacroDetail(macroId) {\r\n    const macro = allMacros.find(m => m.id === macroId);\r\n    if (!macro) return;\r\n    \r\n    displayMacroModal(macro);\r\n}\r\n\r\nfunction displayMacroModal(macro) {\r\n    const modal = document.getElementById('macroModal');\r\n    const modalTitle = document.getElementById('modalTitle');\r\n    const modalBody = document.getElementById('modalBody');\r\n    \r\n    modalTitle.textContent = macro.name || 'æœªå‘½åå®';\r\n    \r\n    let html = '<div class=\"modal-info-grid\">';\r\n    html += `\r\n        <div class=\"modal-info-item\">\r\n            <div class=\"modal-info-label\">å®åç§°</div>\r\n            <div class=\"modal-info-value\">${escapeHtml(macro.name || 'æœªå‘½å')}</div>\r\n        </div>\r\n        <div class=\"modal-info-item\">\r\n            <div class=\"modal-info-label\">åˆ†ç±»</div>\r\n            <div class=\"modal-info-value\">${escapeHtml(macro.category || 'æœªåˆ†ç±»')}</div>\r\n        </div>\r\n        <div class=\"modal-info-item\">\r\n            <div class=\"modal-info-label\">ç±»å‹</div>\r\n            <div class=\"modal-info-value\">${escapeHtml(macro.macroType)}</div>\r\n        </div>\r\n    `;\r\n    html += '</div>';\r\n    \r\n    html += '<div class=\"modal-section\">';\r\n    html += '<div class=\"modal-section-title\">âš™ï¸ å®é…ç½®è¯¦æƒ…</div>';\r\n    \r\n    if (macro.macroType === 'KEYSTROKE') {\r\n        html += renderKeystrokeDetail(macro.macro);\r\n    } else if (macro.macroType === 'SEQUENCE') {\r\n        html += renderSequenceDetail(macro.macro);\r\n    }\r\n    \r\n    html += '</div>';\r\n    \r\n    modalBody.innerHTML = html;\r\n    modal.classList.add('show');\r\n}\r\n\r\nfunction renderKeystrokeDetail(macro) {\r\n    let html = '<div class=\"modal-keystroke\">';\r\n    if (macro.actionName) {\r\n        html += `<div class=\"modal-key\">${escapeHtml(macro.actionName)}</div>`;\r\n    }\r\n    if (macro.keystroke) {\r\n        (macro.keystroke.modifiers || []).forEach(mod => {\r\n            html += `<div class=\"modal-key\">${escapeHtml(getModifierName(mod))}</div>`;\r\n        });\r\n        if (macro.keystroke.code) {\r\n            html += `<div class=\"modal-key\">${escapeHtml(getKeyName(macro.keystroke.code))}</div>`;\r\n        }\r\n    }\r\n    html += '</div>';\r\n    return html;\r\n}\r\n\r\nfunction renderSequenceDetail(macro) {\r\n    const sequence = macro.sequence;\r\n    if (!sequence) return '<div class=\"modal-info-value\">æ— åºåˆ—ä¿¡æ¯</div>';\r\n    \r\n    let html = '<div class=\"modal-sequence-container\">';\r\n    html += `<div class=\"modal-info-label\">é»˜è®¤å»¶è¿Ÿ: ${sequence.defaultDelay || 0}ms</div>`;\r\n    \r\n    const sequenceTypes = [\r\n        { key: 'simpleSequence', label: 'ç®€å•åºåˆ—' },\r\n        { key: 'heldSequence', label: 'æŒ‰ä½åºåˆ—' },\r\n        { key: 'toggleSequence', label: 'åˆ‡æ¢åºåˆ—' }\r\n    ];\r\n    \r\n    for (const seqType of sequenceTypes) {\r\n        if (sequence[seqType.key]?.components?.length > 0) {\r\n            const components = sequence[seqType.key].components;\r\n            html += `<div class=\"modal-info-label\" style=\"margin-top: 15px;\">${seqType.label} (å…± ${components.length} æ­¥):</div>`;\r\n            html += '<div class=\"modal-sequence-steps\">' + renderComponentsDetail(components) + '</div>';\r\n        }\r\n    }\r\n    \r\n    html += '</div>';\r\n    return html;\r\n}\r\n\r\nfunction renderComponentsDetail(components) {\r\n    let html = '';\r\n    components.forEach(component => {\r\n        if (component.keyboard) {\r\n            const isDown = component.keyboard.isDown;\r\n            const className = isDown ? 'key-down' : 'key-up';\r\n            const symbol = isDown ? 'â†“' : 'â†‘';\r\n            html += `<div class=\"modal-sequence-step ${className}\">${symbol} ${escapeHtml(component.keyboard.displayName)}</div>`;\r\n        } else if (component.delay) {\r\n            html += `<div class=\"modal-sequence-step delay\">â± ${component.delay.durationMs}ms</div>`;\r\n        } else if (component.mouse) {\r\n            if (component.mouse.button) {\r\n                const isDown = component.mouse.button.isDown;\r\n                const className = isDown ? 'mouse-down' : 'mouse-up';\r\n                const symbol = isDown ? 'â†“' : 'â†‘';\r\n                html += `<div class=\"modal-sequence-step ${className}\">ğŸ–± ${symbol} ${getMouseButtonName(component.mouse.button.hidUsage)}</div>`;\r\n            }\r\n        }\r\n    });\r\n    return html;\r\n}\r\n\r\nfunction closeModal() {\r\n    document.getElementById('macroModal').classList.remove('show');\r\n}\r\n\r\n// ===== ATK Hub åŒæ­¥åŠŸèƒ½ =====\r\n\r\nlet selectedMacroIds = new Set();\r\n\r\n// ATKè®¾å¤‡é…ç½®\r\nconst ATK_DEVICES = {\r\n    'ATK x QK Hex80': {\r\n        sessionStorage: '__demo_kb_summary_4471',\r\n        type: 'keyboard',\r\n        maxMacros: 16\r\n    },\r\n    'ATK F1 Ultimate 2.0': {\r\n        sessionStorage: '__demo_mouse_summary_4580-ATK F1 Ultimate 2.0',\r\n        localStorage: '__demo_mouse_summary_ATK F1 Ultimate 2.0',\r\n        type: 'mouse',\r\n        maxMacros: 8\r\n    },\r\n    'ATK RS6': {\r\n        sessionStorage: '__demo_mouse_summary_4252-ATK RS6',\r\n        type: 'mouse',\r\n        maxMacros: 8\r\n    }\r\n};\r\n\r\n// G Hub åˆ° ATK é”®ç æ˜ å°„\r\nconst GHUB_TO_ATK_KEYCODE = {\r\n    4: 4, 5: 5, 6: 6, 7: 7, 8: 8, 9: 9, 10: 10, 11: 11, 12: 12, 13: 13,\r\n    14: 14, 15: 15, 16: 16, 17: 17, 18: 18, 19: 19, 20: 20, 21: 21, 22: 22,\r\n    23: 23, 24: 24, 25: 25, 26: 26, 27: 27, 28: 28, 29: 29,\r\n    30: 30, 31: 31, 32: 32, 33: 33, 34: 34, 35: 35, 36: 36, 37: 37, 38: 38, 39: 39,\r\n    40: 40, 41: 41, 42: 42, 43: 43, 44: 44, 45: 45, 46: 46, 47: 47, 48: 48,\r\n    49: 49, 51: 51, 52: 52, 53: 53, 54: 54, 55: 55, 56: 56,\r\n    58: 58, 59: 59, 60: 60, 61: 61, 62: 62, 63: 63, 64: 64, 65: 65,\r\n    66: 66, 67: 67, 68: 68, 69: 69\r\n};\r\n\r\n// è½¬æ¢å®ä¸ºATKæ ¼å¼\r\nfunction convertMacroToATK(macro) {\r\n    if (macro.macroType !== 'SEQUENCE') return null;\r\n    \r\n    const sequence = macro.macro?.sequence;\r\n    if (!sequence) return null;\r\n    \r\n    // æ‰¾åˆ°æœ‰æ•ˆåºåˆ—\r\n    const seqTypes = ['simpleSequence', 'heldSequence', 'toggleSequence', 'pressSequence', 'releaseSequence'];\r\n    let components = null;\r\n    \r\n    for (const type of seqTypes) {\r\n        if (sequence[type]?.components?.length > 0) {\r\n            components = sequence[type].components;\r\n            break;\r\n        }\r\n    }\r\n    \r\n    if (!components) return null;\r\n    \r\n    const actions = [];\r\n    let lastDelay = sequence.defaultDelay || 50;\r\n    \r\n    for (const comp of components) {\r\n        if (comp.delay) {\r\n            lastDelay = comp.delay.durationMs || 50;\r\n        } else if (comp.keyboard) {\r\n            const keyCode = comp.keyboard.hidCode || comp.keyboard.keyCode;\r\n            if (keyCode && GHUB_TO_ATK_KEYCODE[keyCode]) {\r\n                actions.push({\r\n                    delay: lastDelay,\r\n                    keyStatus: comp.keyboard.isDown ? 0 : 1,\r\n                    type: 4,\r\n                    keyCode: GHUB_TO_ATK_KEYCODE[keyCode]\r\n                });\r\n            }\r\n        } else if (comp.mouse?.button) {\r\n            actions.push({\r\n                delay: lastDelay,\r\n                keyStatus: comp.mouse.button.isDown ? 0 : 1,\r\n                type: 1,\r\n                keyCode: parseInt(comp.mouse.button.hidUsage) || 1\r\n            });\r\n        }\r\n    }\r\n    \r\n    if (actions.length === 0) return null;\r\n    \r\n    return {\r\n        name: macro.name,\r\n        type: 0,\r\n        frequency: 1,\r\n        actions: actions\r\n    };\r\n}\r\n\r\n// æ‰“å¼€åŒæ­¥æ¨¡æ€çª—å£\r\nfunction openATKSyncModal() {\r\n    const modal = document.getElementById('atkSyncModal');\r\n    modal.classList.add('show');\r\n    \r\n    document.getElementById('syncScriptPreview').style.display = 'none';\r\n    document.getElementById('syncStatus').innerHTML = '';\r\n    selectedMacroIds.clear();\r\n    updateSelectedCount();\r\n    \r\n    renderMacroCheckboxList();\r\n    populateSyncCategoryFilter();\r\n}\r\n\r\nfunction closeATKSyncModal() {\r\n    document.getElementById('atkSyncModal').classList.remove('show');\r\n}\r\n\r\n// æ¸²æŸ“å®é€‰æ‹©åˆ—è¡¨\r\nfunction renderMacroCheckboxList() {\r\n    const listContainer = document.getElementById('macroCheckboxList');\r\n    \r\n    // åªæ˜¾ç¤ºSEQUENCEç±»å‹çš„å®ï¼ˆå¯è½¬æ¢ï¼‰\r\n    const convertibleMacros = allMacros.filter(m => m.macroType === 'SEQUENCE');\r\n    \r\n    if (convertibleMacros.length === 0) {\r\n        listContainer.innerHTML = '<div class=\"no-results\">æ²¡æœ‰å¯è½¬æ¢çš„å®</div>';\r\n        return;\r\n    }\r\n    \r\n    listContainer.innerHTML = convertibleMacros.map(macro => {\r\n        const isChecked = selectedMacroIds.has(macro.id) ? 'checked' : '';\r\n        const category = macro.category ? `<span class=\"macro-cat-tag\">${escapeHtml(macro.category)}</span>` : '';\r\n        \r\n        return `\r\n            <label class=\"macro-checkbox-item\" data-id=\"${macro.id}\" data-category=\"${macro.category || ''}\" data-name=\"${escapeHtml(macro.name)}\">\r\n                <input type=\"checkbox\" value=\"${macro.id}\" ${isChecked} onchange=\"toggleMacroSelection('${macro.id}')\">\r\n                <div class=\"macro-checkbox-info\">\r\n                    <span class=\"macro-checkbox-name\">${escapeHtml(macro.name)}</span>\r\n                    <span class=\"macro-checkbox-meta\">${macro.macroType} ${category}</span>\r\n                </div>\r\n            </label>\r\n        `;\r\n    }).join('');\r\n}\r\n\r\nfunction populateSyncCategoryFilter() {\r\n    const categoryFilter = document.getElementById('syncCategoryFilter');\r\n    const categories = new Set();\r\n    \r\n    allMacros.filter(m => m.macroType === 'SEQUENCE').forEach(macro => {\r\n        if (macro.category) categories.add(macro.category);\r\n    });\r\n    \r\n    categoryFilter.innerHTML = '<option value=\"\">å…¨éƒ¨åˆ†ç±»</option>';\r\n    Array.from(categories).sort().forEach(cat => {\r\n        const option = document.createElement('option');\r\n        option.value = cat;\r\n        option.textContent = cat;\r\n        categoryFilter.appendChild(option);\r\n    });\r\n}\r\n\r\nfunction toggleMacroSelection(macroId) {\r\n    if (selectedMacroIds.has(macroId)) {\r\n        selectedMacroIds.delete(macroId);\r\n    } else {\r\n        selectedMacroIds.add(macroId);\r\n    }\r\n    updateSelectedCount();\r\n}\r\n\r\nfunction updateSelectedCount() {\r\n    document.getElementById('selectedMacroCount').textContent = selectedMacroIds.size;\r\n}\r\n\r\nfunction selectAllMacros() {\r\n    document.querySelectorAll('#macroCheckboxList .macro-checkbox-item:not([style*=\"display: none\"])').forEach(item => {\r\n        const checkbox = item.querySelector('input[type=\"checkbox\"]');\r\n        checkbox.checked = true;\r\n        selectedMacroIds.add(item.dataset.id);\r\n    });\r\n    updateSelectedCount();\r\n}\r\n\r\nfunction deselectAllMacros() {\r\n    document.querySelectorAll('#macroCheckboxList .macro-checkbox-item:not([style*=\"display: none\"])').forEach(item => {\r\n        const checkbox = item.querySelector('input[type=\"checkbox\"]');\r\n        checkbox.checked = false;\r\n        selectedMacroIds.delete(item.dataset.id);\r\n    });\r\n    updateSelectedCount();\r\n}\r\n\r\nfunction filterSyncMacros() {\r\n    const searchTerm = document.getElementById('syncSearchInput').value.toLowerCase();\r\n    const category = document.getElementById('syncCategoryFilter').value;\r\n    \r\n    document.querySelectorAll('#macroCheckboxList .macro-checkbox-item').forEach(item => {\r\n        const name = item.dataset.name.toLowerCase();\r\n        const itemCategory = item.dataset.category;\r\n        \r\n        const matchesSearch = !searchTerm || name.includes(searchTerm);\r\n        const matchesCategory = !category || itemCategory === category;\r\n        \r\n        item.style.display = (matchesSearch && matchesCategory) ? '' : 'none';\r\n    });\r\n}\r\n\r\n// ç”ŸæˆåŒæ­¥è„šæœ¬\r\nfunction generateSyncScript() {\r\n    const statusDiv = document.getElementById('syncStatus');\r\n    \r\n    if (selectedMacroIds.size === 0) {\r\n        statusDiv.innerHTML = '<div class=\"status-error\">âŒ è¯·è‡³å°‘é€‰æ‹©ä¸€ä¸ªå®</div>';\r\n        return;\r\n    }\r\n    \r\n    // è½¬æ¢é€‰ä¸­çš„å®\r\n    const atkMacros = [];\r\n    selectedMacroIds.forEach(id => {\r\n        const macro = allMacros.find(m => m.id === id);\r\n        if (macro) {\r\n            const converted = convertMacroToATK(macro);\r\n            if (converted) atkMacros.push(converted);\r\n        }\r\n    });\r\n    \r\n    if (atkMacros.length === 0) {\r\n        statusDiv.innerHTML = '<div class=\"status-error\">âŒ æ²¡æœ‰å¯è½¬æ¢çš„å®ï¼ˆåªæ”¯æŒSEQUENCEç±»å‹ï¼‰</div>';\r\n        return;\r\n    }\r\n    \r\n    const device = document.getElementById('syncDevice').value;\r\n    const mode = document.getElementById('syncMode').value;\r\n    const deviceInfo = ATK_DEVICES[device];\r\n    \r\n    let script;\r\n    if (deviceInfo.type === 'keyboard') {\r\n        script = generateKeyboardScript(atkMacros, deviceInfo.sessionStorage, mode);\r\n    } else {\r\n        script = generateMouseScript(atkMacros, deviceInfo.sessionStorage, mode);\r\n    }\r\n    \r\n    // å¤åˆ¶åˆ°å‰ªè´´æ¿\r\n    navigator.clipboard.writeText(script).then(() => {\r\n        document.getElementById('syncScriptContent').textContent = script;\r\n        document.getElementById('syncScriptPreview').style.display = 'block';\r\n        \r\n        const modeText = {replace: 'æ›¿æ¢', append: 'è¿½åŠ ', merge: 'åˆå¹¶'}[mode];\r\n        statusDiv.innerHTML = `\r\n            <div class=\"status-success\">\r\n                âœ… åŒæ­¥ä»£ç å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼<br>\r\n                <strong>å…± ${atkMacros.length} ä¸ªå®</strong> | ç›®æ ‡: ${device} | æ¨¡å¼: ${modeText}<br>\r\n                <small>è¯·åˆ°ATK Hubé¡µé¢æŒ‰F12æ‰“å¼€æ§åˆ¶å°ï¼Œç²˜è´´æ‰§è¡Œ</small>\r\n            </div>\r\n        `;\r\n    }).catch(err => {\r\n        statusDiv.innerHTML = `<div class=\"status-error\">âŒ å¤åˆ¶å¤±è´¥: ${err.message}</div>`;\r\n    });\r\n}\r\n\r\nfunction generateKeyboardScript(macros, storageKey, mode) {\r\n    const macrosJson = JSON.stringify(macros);\r\n    return `\r\n(function() {\r\n    const newMacros = ${macrosJson};\r\n    const storageKey = '${storageKey}';\r\n    const mode = '${mode}';\r\n    \r\n    let data = sessionStorage.getItem(storageKey);\r\n    if (!data) {\r\n        console.error('âŒ æœªæ‰¾åˆ°è®¾å¤‡æ•°æ®ï¼Œè¯·ç¡®ä¿å·²è¿›å…¥æ¼”ç¤ºæ¨¡å¼å¹¶é€‰æ‹©äº†é”®ç›˜è®¾å¤‡');\r\n        return { success: false, error: 'Device data not found' };\r\n    }\r\n    \r\n    try {\r\n        const parsed = JSON.parse(data);\r\n        \r\n        if (!parsed.deviceConfig) parsed.deviceConfig = {};\r\n        if (!parsed.deviceConfig.macroList) parsed.deviceConfig.macroList = [];\r\n        \r\n        let currentMacros = parsed.deviceConfig.macroList;\r\n        \r\n        if (mode === 'replace') {\r\n            const maxSlots = 16;\r\n            const defaultMacros = [];\r\n            for (let i = 0; i < maxSlots; i++) {\r\n                if (i < newMacros.length) {\r\n                    defaultMacros.push(newMacros[i]);\r\n                } else if (i < 8) {\r\n                    defaultMacros.push({ name: 'M' + (i + 1), type: 0, frequency: 1, actions: [] });\r\n                }\r\n            }\r\n            currentMacros = defaultMacros;\r\n        } else if (mode === 'append') {\r\n            currentMacros = [...currentMacros, ...newMacros];\r\n        } else if (mode === 'merge') {\r\n            const macroMap = new Map(currentMacros.map(m => [m.name, m]));\r\n            newMacros.forEach(m => macroMap.set(m.name, m));\r\n            currentMacros = Array.from(macroMap.values());\r\n        }\r\n        \r\n        parsed.deviceConfig.macroList = currentMacros;\r\n        sessionStorage.setItem(storageKey, JSON.stringify(parsed));\r\n        \r\n        console.log('âœ… å®åŒæ­¥æˆåŠŸ!');\r\n        console.log('ğŸ“ å…±åŒæ­¥ ' + newMacros.length + ' ä¸ªå®');\r\n        console.log('ğŸ’¡ åˆ·æ–°é¡µé¢æˆ–åˆ‡æ¢åˆ°å®è®¾ç½®é¡µé¢æŸ¥çœ‹æ•ˆæœ');\r\n        \r\n        return { success: true, count: newMacros.length, total: currentMacros.length };\r\n    } catch (e) {\r\n        console.error('âŒ åŒæ­¥å¤±è´¥:', e);\r\n        return { success: false, error: e.message };\r\n    }\r\n})();\r\n`;\r\n}\r\n\r\nfunction generateMouseScript(macros, storageKey, mode) {\r\n    const macrosJson = JSON.stringify(macros);\r\n    return `\r\n(function() {\r\n    const newMacros = ${macrosJson};\r\n    const storageKey = '${storageKey}';\r\n    const mode = '${mode}';\r\n    \r\n    let data = sessionStorage.getItem(storageKey);\r\n    if (!data) {\r\n        console.error('âŒ æœªæ‰¾åˆ°è®¾å¤‡æ•°æ®ï¼Œè¯·ç¡®ä¿å·²è¿›å…¥æ¼”ç¤ºæ¨¡å¼å¹¶é€‰æ‹©äº†é¼ æ ‡è®¾å¤‡');\r\n        return { success: false, error: 'Device data not found' };\r\n    }\r\n    \r\n    try {\r\n        const parsed = JSON.parse(data);\r\n        \r\n        if (!parsed.deviceConfig) parsed.deviceConfig = {};\r\n        if (!parsed.deviceConfig.macroList) parsed.deviceConfig.macroList = [];\r\n        \r\n        let currentMacros = parsed.deviceConfig.macroList;\r\n        \r\n        if (mode === 'replace') {\r\n            currentMacros = newMacros.slice(0, 8);\r\n        } else if (mode === 'append') {\r\n            currentMacros = [...currentMacros, ...newMacros].slice(0, 8);\r\n        } else if (mode === 'merge') {\r\n            const macroMap = new Map(currentMacros.map(m => [m.name, m]));\r\n            newMacros.forEach(m => macroMap.set(m.name, m));\r\n            currentMacros = Array.from(macroMap.values()).slice(0, 8);\r\n        }\r\n        \r\n        parsed.deviceConfig.macroList = currentMacros;\r\n        sessionStorage.setItem(storageKey, JSON.stringify(parsed));\r\n        \r\n        console.log('âœ… é¼ æ ‡å®åŒæ­¥æˆåŠŸ!');\r\n        console.log('ğŸ“ å…±åŒæ­¥ ' + newMacros.length + ' ä¸ªå®');\r\n        console.log('ğŸ’¡ åˆ·æ–°é¡µé¢æˆ–åˆ‡æ¢åˆ°å®è®¾ç½®é¡µé¢æŸ¥çœ‹æ•ˆæœ');\r\n        \r\n        return { success: true, count: newMacros.length, total: currentMacros.length };\r\n    } catch (e) {\r\n        console.error('âŒ åŒæ­¥å¤±è´¥:', e);\r\n        return { success: false, error: e.message };\r\n    }\r\n})();\r\n`;\r\n}\r\n\r\n// ===== äº‹ä»¶ç»‘å®š =====\r\n\r\ndocument.addEventListener('DOMContentLoaded', function() {\r\n    // æœç´¢\r\n    document.getElementById('searchBtn').addEventListener('click', searchMacros);\r\n    document.getElementById('searchInput').addEventListener('keyup', e => {\r\n        if (e.key === 'Enter') searchMacros();\r\n    });\r\n    document.getElementById('categoryFilter').addEventListener('change', searchMacros);\r\n    \r\n    // è¯¦æƒ…æ¨¡æ€çª—å£\r\n    document.querySelector('#macroModal .modal-close').addEventListener('click', closeModal);\r\n    window.addEventListener('click', e => {\r\n        if (e.target === document.getElementById('macroModal')) closeModal();\r\n        if (e.target === document.getElementById('atkSyncModal')) closeATKSyncModal();\r\n    });\r\n    document.addEventListener('keydown', e => {\r\n        if (e.key === 'Escape') {\r\n            closeModal();\r\n            closeATKSyncModal();\r\n        }\r\n    });\r\n    \r\n    // ATKåŒæ­¥\r\n    document.getElementById('syncATKBtn').addEventListener('click', openATKSyncModal);\r\n    document.getElementById('generateSyncBtn').addEventListener('click', generateSyncScript);\r\n    \r\n    // åŠ è½½æ•°æ®\r\n    loadMacroData();\r\n});\r\n";
export const STYLE_CSS = "* {\n    margin: 0;\n    padding: 0;\n    box-sizing: border-box;\n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    min-height: 100vh;\n    padding: 20px;\n}\n\n.container {\n    max-width: 1400px;\n    margin: 0 auto;\n    background: white;\n    border-radius: 20px;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);\n    overflow: hidden;\n}\n\nheader {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    padding: 40px;\n    text-align: center;\n}\n\nheader h1 {\n    font-size: 2.5em;\n    margin-bottom: 10px;\n    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);\n}\n\n.subtitle {\n    font-size: 1.1em;\n    opacity: 0.9;\n}\n\n.controls {\n    padding: 30px;\n    background: #f8f9fa;\n    border-bottom: 2px solid #e9ecef;\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n    align-items: center;\n}\n\n.search-box {\n    flex: 1;\n    min-width: 300px;\n    display: flex;\n    gap: 10px;\n}\n\n.search-box input {\n    flex: 1;\n    padding: 12px 20px;\n    border: 2px solid #dee2e6;\n    border-radius: 10px;\n    font-size: 16px;\n    transition: all 0.3s;\n}\n\n.search-box input:focus {\n    outline: none;\n    border-color: #667eea;\n    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n}\n\n.search-box button {\n    padding: 12px 30px;\n    background: #667eea;\n    color: white;\n    border: none;\n    border-radius: 10px;\n    font-size: 16px;\n    cursor: pointer;\n    transition: all 0.3s;\n    font-weight: 600;\n}\n\n.search-box button:hover {\n    background: #5568d3;\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);\n}\n\n.filter-box {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.filter-box label {\n    font-weight: 600;\n    color: #495057;\n}\n\n.filter-box select {\n    padding: 12px 20px;\n    border: 2px solid #dee2e6;\n    border-radius: 10px;\n    font-size: 16px;\n    cursor: pointer;\n    background: white;\n    min-width: 150px;\n}\n\n.stats {\n    margin-left: auto;\n    display: flex;\n    gap: 15px;\n    font-weight: 600;\n    color: #495057;\n}\n\n.stats span {\n    padding: 10px 20px;\n    background: white;\n    border-radius: 10px;\n    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n}\n\n.macro-list {\n    padding: 30px;\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\n    gap: 20px;\n    max-height: calc(100vh - 400px);\n    overflow-y: auto;\n}\n\n.loading {\n    grid-column: 1 / -1;\n    text-align: center;\n    padding: 60px;\n    font-size: 1.2em;\n    color: #6c757d;\n}\n\n.macro-card {\n    background: white;\n    border: 2px solid #e9ecef;\n    border-radius: 15px;\n    padding: 20px;\n    transition: all 0.3s;\n    cursor: pointer;\n}\n\n.macro-card:hover {\n    transform: translateY(-5px);\n    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);\n    border-color: #667eea;\n}\n\n.macro-card.hidden {\n    display: none;\n}\n\n.macro-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: start;\n    margin-bottom: 15px;\n}\n\n.macro-name {\n    font-size: 1.2em;\n    font-weight: 700;\n    color: #212529;\n    flex: 1;\n    word-break: break-word;\n}\n\n.macro-category {\n    padding: 5px 12px;\n    background: #667eea;\n    color: white;\n    border-radius: 20px;\n    font-size: 0.85em;\n    font-weight: 600;\n    white-space: nowrap;\n}\n\n.macro-type {\n    display: inline-block;\n    padding: 8px 15px;\n    background: #f8f9fa;\n    border-radius: 8px;\n    font-size: 0.9em;\n    font-weight: 600;\n    color: #495057;\n    margin-bottom: 10px;\n}\n\n.macro-keys {\n    margin-top: 15px;\n    padding-top: 15px;\n    border-top: 2px solid #f8f9fa;\n}\n\n.key-display {\n    display: inline-block;\n    padding: 8px 15px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-radius: 8px;\n    font-weight: 700;\n    font-size: 1em;\n    margin: 5px 5px 5px 0;\n    box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);\n}\n\n.sequence-info {\n    margin-top: 10px;\n    padding: 10px;\n    background: #f8f9fa;\n    border-radius: 8px;\n    font-size: 0.9em;\n    color: #6c757d;\n}\n\n.sequence-steps {\n    margin-top: 10px;\n    display: flex;\n    flex-wrap: wrap;\n    gap: 5px;\n}\n\n.sequence-step {\n    padding: 5px 10px;\n    background: #e9ecef;\n    border-radius: 5px;\n    font-size: 0.85em;\n    font-weight: 600;\n}\n\n.sequence-step.key-down {\n    background: #d4edda;\n    color: #155724;\n}\n\n.sequence-step.key-up {\n    background: #f8d7da;\n    color: #721c24;\n}\n\n.sequence-step.delay {\n    background: #fff3cd;\n    color: #856404;\n}\n\n.sequence-step.mouse-down {\n    background: #cfe2ff;\n    color: #084298;\n}\n\n.sequence-step.mouse-up {\n    background: #e7f1ff;\n    color: #0a58ca;\n}\n\n.sequence-step.mouse-wheel {\n    background: #e0cffc;\n    color: #6f42c1;\n}\n\n.sequence-step.mouse-move {\n    background: #d1e7dd;\n    color: #0f5132;\n}\n\n.sequence-step.mouse-action {\n    background: #cfe2ff;\n    color: #084298;\n}\n\n.no-results {\n    grid-column: 1 / -1;\n    text-align: center;\n    padding: 60px;\n    font-size: 1.2em;\n    color: #6c757d;\n}\n\n/* æ»šåŠ¨æ¡æ ·å¼ */\n.macro-list::-webkit-scrollbar {\n    width: 10px;\n}\n\n.macro-list::-webkit-scrollbar-track {\n    background: #f1f1f1;\n    border-radius: 10px;\n}\n\n.macro-list::-webkit-scrollbar-thumb {\n    background: #667eea;\n    border-radius: 10px;\n}\n\n.macro-list::-webkit-scrollbar-thumb:hover {\n    background: #5568d3;\n}\n\n/* åˆ†é¡µæ ·å¼ */\n.pagination {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 10px;\n    padding: 30px;\n    background: #f8f9fa;\n    border-top: 2px solid #e9ecef;\n}\n\n.page-btn {\n    padding: 10px 18px;\n    background: white;\n    color: #495057;\n    border: 2px solid #dee2e6;\n    border-radius: 8px;\n    font-size: 15px;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s;\n    min-width: 45px;\n}\n\n.page-btn:hover {\n    background: #667eea;\n    color: white;\n    border-color: #667eea;\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);\n}\n\n.page-btn.active {\n    background: #667eea;\n    color: white;\n    border-color: #667eea;\n    box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);\n}\n\n.page-dots {\n    color: #6c757d;\n    font-weight: bold;\n    padding: 0 5px;\n}\n\n/* æ¨¡æ€çª—å£æ ·å¼ */\n.modal {\n    display: none;\n    position: fixed;\n    z-index: 1000;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    overflow: auto;\n    background-color: rgba(0, 0, 0, 0.6);\n    animation: fadeIn 0.3s;\n}\n\n.modal.show {\n    display: block;\n}\n\n@keyframes fadeIn {\n    from { opacity: 0; }\n    to { opacity: 1; }\n}\n\n.modal-content {\n    background-color: white;\n    margin: 3% auto;\n    padding: 0;\n    border-radius: 20px;\n    width: 90%;\n    max-width: 900px;\n    max-height: 85vh;\n    overflow: hidden;\n    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);\n    animation: slideDown 0.3s;\n}\n\n@keyframes slideDown {\n    from {\n        transform: translateY(-50px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n.modal-header {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    padding: 25px 30px;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.modal-header h2 {\n    margin: 0;\n    font-size: 1.8em;\n}\n\n.modal-close {\n    color: white;\n    font-size: 35px;\n    font-weight: bold;\n    cursor: pointer;\n    transition: all 0.3s;\n    line-height: 1;\n    padding: 0 10px;\n}\n\n.modal-close:hover {\n    transform: scale(1.2);\n    text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);\n}\n\n.modal-body {\n    padding: 30px;\n    max-height: calc(85vh - 100px);\n    overflow-y: auto;\n}\n\n.modal-info-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 20px;\n    margin-bottom: 30px;\n}\n\n.modal-info-item {\n    background: #f8f9fa;\n    padding: 15px 20px;\n    border-radius: 10px;\n    border-left: 4px solid #667eea;\n}\n\n.modal-info-label {\n    font-weight: 700;\n    color: #495057;\n    font-size: 0.9em;\n    margin-bottom: 5px;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n}\n\n.modal-info-value {\n    font-size: 1.1em;\n    color: #212529;\n    word-break: break-word;\n}\n\n.modal-section {\n    margin-top: 30px;\n    padding-top: 30px;\n    border-top: 2px solid #e9ecef;\n}\n\n.modal-section-title {\n    font-size: 1.4em;\n    font-weight: 700;\n    color: #212529;\n    margin-bottom: 20px;\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.modal-sequence-container {\n    background: #f8f9fa;\n    padding: 20px;\n    border-radius: 10px;\n}\n\n.modal-sequence-steps {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 8px;\n    margin-top: 15px;\n}\n\n.modal-sequence-step {\n    padding: 10px 15px;\n    border-radius: 8px;\n    font-weight: 600;\n    font-size: 0.95em;\n    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);\n}\n\n/* æ¨¡æ€çª—å£åºåˆ—æ­¥éª¤é¢œè‰² - ä¸ä¸»åˆ—è¡¨ä¸€è‡´ */\n.modal-sequence-step.key-down {\n    background: #d4edda;\n    color: #155724;\n}\n\n.modal-sequence-step.key-up {\n    background: #f8d7da;\n    color: #721c24;\n}\n\n.modal-sequence-step.delay {\n    background: #fff3cd;\n    color: #856404;\n}\n\n.modal-sequence-step.mouse-down {\n    background: #cfe2ff;\n    color: #084298;\n}\n\n.modal-sequence-step.mouse-up {\n    background: #e7f1ff;\n    color: #0a58ca;\n}\n\n.modal-sequence-step.mouse-wheel {\n    background: #e0cffc;\n    color: #6f42c1;\n}\n\n.modal-sequence-step.mouse-move {\n    background: #d1e7dd;\n    color: #0f5132;\n}\n\n.modal-sequence-step.mouse-action {\n    background: #cfe2ff;\n    color: #084298;\n}\n\n.modal-keystroke {\n    display: flex;\n    gap: 10px;\n    flex-wrap: wrap;\n}\n\n.modal-key {\n    padding: 15px 25px;\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    border-radius: 10px;\n    font-weight: 700;\n    font-size: 1.2em;\n    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);\n}\n\n.modal-body::-webkit-scrollbar {\n    width: 10px;\n}\n\n.modal-body::-webkit-scrollbar-track {\n    background: #f1f1f1;\n    border-radius: 10px;\n}\n\n.modal-body::-webkit-scrollbar-thumb {\n    background: #667eea;\n    border-radius: 10px;\n}\n\n.modal-body::-webkit-scrollbar-thumb:hover {\n    background: #5568d3;\n}\n\n/* ATKå¯¼å‡ºæŒ‰é’® */\n.export-box {\n    display: flex;\n    align-items: center;\n}\n\n.export-btn {\n    padding: 12px 25px;\n    background: linear-gradient(135deg, #00c853 0%, #00e676 100%);\n    color: white;\n    border: none;\n    border-radius: 10px;\n    font-size: 16px;\n    cursor: pointer;\n    transition: all 0.3s;\n    font-weight: 600;\n    box-shadow: 0 3px 10px rgba(0, 200, 83, 0.3);\n}\n\n.export-btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 5px 20px rgba(0, 200, 83, 0.4);\n}\n\n/* ATKå¯¼å‡ºæ¨¡æ€çª—å£ */\n.export-options {\n    margin-bottom: 25px;\n}\n\n.export-option {\n    margin-bottom: 20px;\n}\n\n.export-option label {\n    display: block;\n    font-weight: 600;\n    color: #495057;\n    margin-bottom: 8px;\n}\n\n.export-option input {\n    width: 100%;\n    padding: 12px 15px;\n    border: 2px solid #dee2e6;\n    border-radius: 8px;\n    font-size: 16px;\n    transition: all 0.3s;\n}\n\n.export-option input:focus {\n    outline: none;\n    border-color: #667eea;\n    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n}\n\n.export-info {\n    background: #f8f9fa;\n    padding: 15px 20px;\n    border-radius: 10px;\n    border-left: 4px solid #667eea;\n}\n\n.export-info p {\n    margin: 5px 0;\n    color: #495057;\n}\n\n.export-actions {\n    display: flex;\n    gap: 15px;\n    flex-wrap: wrap;\n    margin-bottom: 20px;\n}\n\n.btn {\n    padding: 12px 25px;\n    border: none;\n    border-radius: 10px;\n    font-size: 15px;\n    font-weight: 600;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.btn-primary {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    color: white;\n    box-shadow: 0 3px 10px rgba(102, 126, 234, 0.3);\n}\n\n.btn-primary:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);\n}\n\n.btn-secondary {\n    background: #6c757d;\n    color: white;\n    box-shadow: 0 3px 10px rgba(108, 117, 125, 0.3);\n}\n\n.btn-secondary:hover {\n    background: #5a6268;\n    transform: translateY(-2px);\n    box-shadow: 0 5px 15px rgba(108, 117, 125, 0.4);\n}\n\n.atk-preview {\n    background: #2d2d2d;\n    border-radius: 10px;\n    padding: 20px;\n    margin-top: 20px;\n}\n\n.atk-preview h4 {\n    color: #00e676;\n    margin-bottom: 15px;\n}\n\n.atk-preview pre {\n    color: #e0e0e0;\n    font-family: 'Consolas', 'Monaco', monospace;\n    font-size: 13px;\n    line-height: 1.5;\n    white-space: pre-wrap;\n    word-break: break-all;\n    max-height: 300px;\n    overflow-y: auto;\n    margin: 0;\n}\n\n.atk-preview pre::-webkit-scrollbar {\n    width: 8px;\n}\n\n.atk-preview pre::-webkit-scrollbar-track {\n    background: #1a1a1a;\n    border-radius: 4px;\n}\n\n.atk-preview pre::-webkit-scrollbar-thumb {\n    background: #555;\n    border-radius: 4px;\n}\n\n.atk-preview pre::-webkit-scrollbar-thumb:hover {\n    background: #666;\n}\n\n/* ===== ATK Hub åŒæ­¥æ ·å¼ ===== */\n.sync-btn {\n    background: linear-gradient(135deg, #ff6b6b 0%, #ee5a5a 100%);\n    margin-left: 10px;\n    box-shadow: 0 3px 10px rgba(255, 107, 107, 0.3);\n}\n\n.sync-btn:hover {\n    box-shadow: 0 5px 20px rgba(255, 107, 107, 0.4);\n}\n\n.modal-lg {\n    max-width: 1000px;\n}\n\n.sync-instructions {\n    background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);\n    border: 2px solid #667eea30;\n    border-radius: 12px;\n    padding: 20px;\n    margin-bottom: 25px;\n}\n\n.sync-instructions h3 {\n    color: #667eea;\n    margin-bottom: 15px;\n    font-size: 1.2em;\n}\n\n.sync-instructions ol {\n    padding-left: 20px;\n    color: #495057;\n    line-height: 1.8;\n}\n\n.sync-instructions li {\n    margin: 8px 0;\n}\n\n.link-atk {\n    color: #ff6b6b;\n    font-weight: 600;\n    text-decoration: none;\n}\n\n.link-atk:hover {\n    text-decoration: underline;\n}\n\n.sync-options {\n    margin-bottom: 25px;\n}\n\n.sync-option {\n    margin-bottom: 20px;\n}\n\n.sync-option label {\n    display: block;\n    font-weight: 600;\n    color: #495057;\n    margin-bottom: 8px;\n}\n\n.sync-option select {\n    width: 100%;\n    padding: 12px 15px;\n    border: 2px solid #dee2e6;\n    border-radius: 8px;\n    font-size: 16px;\n    background: white;\n    cursor: pointer;\n    transition: all 0.3s;\n}\n\n.sync-option select:focus {\n    outline: none;\n    border-color: #667eea;\n    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);\n}\n\n.sync-option-row {\n    display: flex;\n    gap: 20px;\n    flex-wrap: wrap;\n}\n\n.sync-option-row .sync-option {\n    flex: 1;\n    min-width: 200px;\n}\n\n/* å®é€‰æ‹©åŒºåŸŸ */\n.macro-selection {\n    background: #f8f9fa;\n    border-radius: 12px;\n    padding: 20px;\n    margin-bottom: 20px;\n}\n\n.selection-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 15px;\n    flex-wrap: wrap;\n    gap: 10px;\n}\n\n.selection-header h4 {\n    margin: 0;\n    color: #495057;\n    font-size: 1.1em;\n}\n\n.selection-actions {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n}\n\n.btn-sm {\n    padding: 6px 14px;\n    background: #6c757d;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    font-size: 13px;\n    cursor: pointer;\n    transition: all 0.2s;\n}\n\n.btn-sm:hover {\n    background: #5a6268;\n}\n\n.selected-count {\n    font-size: 14px;\n    color: #495057;\n    padding: 6px 12px;\n    background: white;\n    border-radius: 6px;\n    box-shadow: 0 1px 3px rgba(0,0,0,0.1);\n}\n\n.selected-count strong {\n    color: #ff6b6b;\n    font-size: 16px;\n}\n\n.macro-filter {\n    display: flex;\n    gap: 10px;\n    margin-bottom: 15px;\n}\n\n.macro-filter input {\n    flex: 1;\n    padding: 10px 15px;\n    border: 2px solid #dee2e6;\n    border-radius: 8px;\n    font-size: 14px;\n}\n\n.macro-filter input:focus {\n    outline: none;\n    border-color: #667eea;\n}\n\n.macro-filter select {\n    padding: 10px 15px;\n    border: 2px solid #dee2e6;\n    border-radius: 8px;\n    font-size: 14px;\n    background: white;\n    min-width: 150px;\n}\n\n.macro-checkbox-list {\n    max-height: 300px;\n    overflow-y: auto;\n    background: white;\n    border-radius: 8px;\n    border: 1px solid #dee2e6;\n}\n\n.macro-checkbox-list::-webkit-scrollbar {\n    width: 8px;\n}\n\n.macro-checkbox-list::-webkit-scrollbar-track {\n    background: #f1f1f1;\n    border-radius: 4px;\n}\n\n.macro-checkbox-list::-webkit-scrollbar-thumb {\n    background: #c1c1c1;\n    border-radius: 4px;\n}\n\n.macro-checkbox-list::-webkit-scrollbar-thumb:hover {\n    background: #a1a1a1;\n}\n\n.macro-checkbox-item {\n    display: flex;\n    align-items: center;\n    padding: 12px 15px;\n    border-bottom: 1px solid #f0f0f0;\n    cursor: pointer;\n    transition: background 0.2s;\n}\n\n.macro-checkbox-item:hover {\n    background: #f8f9fa;\n}\n\n.macro-checkbox-item:last-child {\n    border-bottom: none;\n}\n\n.macro-checkbox-item input[type=\"checkbox\"] {\n    width: 18px;\n    height: 18px;\n    margin-right: 12px;\n    cursor: pointer;\n    accent-color: #667eea;\n}\n\n.macro-checkbox-info {\n    flex: 1;\n    min-width: 0;\n}\n\n.macro-checkbox-name {\n    display: block;\n    font-weight: 600;\n    color: #212529;\n    font-size: 14px;\n    white-space: nowrap;\n    overflow: hidden;\n    text-overflow: ellipsis;\n}\n\n.macro-checkbox-meta {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    font-size: 12px;\n    color: #6c757d;\n    margin-top: 3px;\n}\n\n.macro-cat-tag {\n    background: #667eea;\n    color: white;\n    padding: 2px 8px;\n    border-radius: 10px;\n    font-size: 11px;\n}\n\n.macro-checkbox-list .loading,\n.macro-checkbox-list .no-results {\n    padding: 30px;\n    text-align: center;\n    color: #6c757d;\n}\n\n.sync-actions {\n    display: flex;\n    gap: 15px;\n    flex-wrap: wrap;\n    margin-bottom: 20px;\n}\n\n.sync-preview {\n    background: #1e1e1e;\n    border-radius: 10px;\n    padding: 20px;\n    margin-top: 20px;\n    border: 1px solid #333;\n}\n\n.sync-preview h4 {\n    color: #00ff88;\n    margin-bottom: 15px;\n    font-size: 1em;\n}\n\n.sync-preview pre {\n    color: #d4d4d4;\n    font-family: 'Consolas', 'Monaco', 'Courier New', monospace;\n    font-size: 12px;\n    line-height: 1.4;\n    white-space: pre-wrap;\n    word-break: break-all;\n    max-height: 250px;\n    overflow-y: auto;\n    margin: 0;\n    background: #2d2d2d;\n    padding: 15px;\n    border-radius: 8px;\n}\n\n.sync-preview pre::-webkit-scrollbar {\n    width: 8px;\n}\n\n.sync-preview pre::-webkit-scrollbar-track {\n    background: #1a1a1a;\n    border-radius: 4px;\n}\n\n.sync-preview pre::-webkit-scrollbar-thumb {\n    background: #555;\n    border-radius: 4px;\n}\n\n.sync-status {\n    margin-top: 15px;\n}\n\n.status-success {\n    background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);\n    color: #155724;\n    padding: 15px 20px;\n    border-radius: 10px;\n    border-left: 4px solid #28a745;\n    line-height: 1.6;\n}\n\n.status-success strong {\n    display: block;\n    margin-bottom: 5px;\n}\n\n.status-success small {\n    opacity: 0.8;\n}\n\n.status-error {\n    background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);\n    color: #721c24;\n    padding: 15px 20px;\n    border-radius: 10px;\n    border-left: 4px solid #dc3545;\n}\n\n.status-loading {\n    background: linear-gradient(135deg, #fff3cd 0%, #ffeeba 100%);\n    color: #856404;\n    padding: 15px 20px;\n    border-radius: 10px;\n    border-left: 4px solid #ffc107;\n    animation: pulse 1.5s infinite;\n}\n\n@keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.7; }\n}\n\n/* å“åº”å¼ */\n@media (max-width: 768px) {\n    .controls {\n        flex-direction: column;\n        align-items: stretch;\n    }\n\n    .search-box {\n        min-width: 100%;\n    }\n\n    .stats {\n        margin-left: 0;\n        flex-direction: column;\n        gap: 10px;\n    }\n\n    .macro-list {\n        grid-template-columns: 1fr;\n    }\n    \n    .pagination {\n        flex-wrap: wrap;\n        gap: 5px;\n    }\n    \n    .page-btn {\n        padding: 8px 12px;\n        font-size: 14px;\n        min-width: 40px;\n    }\n    \n    .modal-content {\n        width: 95%;\n        margin: 5% auto;\n    }\n    \n    .modal-info-grid {\n        grid-template-columns: 1fr;\n    }\n    \n    .modal-header h2 {\n        font-size: 1.3em;\n    }\n    \n    .export-box {\n        width: 100%;\n        flex-direction: column;\n        gap: 10px;\n    }\n    \n    .export-btn {\n        width: 100%;\n    }\n    \n    .sync-btn {\n        margin-left: 0;\n    }\n    \n    .export-actions,\n    .sync-actions {\n        flex-direction: column;\n    }\n    \n    .btn {\n        width: 100%;\n    }\n    \n    .sync-instructions ol {\n        padding-left: 15px;\n        font-size: 0.95em;\n    }\n}\n";
